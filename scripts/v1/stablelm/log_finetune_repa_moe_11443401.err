Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:45<00:45, 45.28s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:46<00:46, 46.01s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:46<00:46, 46.01s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:46<00:46, 46.01s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:52<00:00, 22.80s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:52<00:00, 26.29s/it]
Some weights of RePaMoELLaVAStablelmForCausalLM were not initialized from the model checkpoint at ./checkpoints/MoE-LLaVA-StableLM-1.6B-4e and are newly initialized: ['model.layers.0.mlp.deepspeed_moe.experts.deepspeed_experts.0.mask', 'model.layers.0.mlp.deepspeed_moe.experts.deepspeed_experts.1.mask', 'model.layers.0.mlp.deepspeed_moe.experts.deepspeed_experts.2.mask', 'model.layers.0.mlp.deepspeed_moe.experts.deepspeed_experts.3.mask', 'model.layers.10.mlp.deepspeed_moe.experts.deepspeed_experts.0.mask', 'model.layers.10.mlp.deepspeed_moe.experts.deepspeed_experts.1.mask', 'model.layers.10.mlp.deepspeed_moe.experts.deepspeed_experts.2.mask', 'model.layers.10.mlp.deepspeed_moe.experts.deepspeed_experts.3.mask', 'model.layers.12.mlp.deepspeed_moe.experts.deepspeed_experts.0.mask', 'model.layers.12.mlp.deepspeed_moe.experts.deepspeed_experts.1.mask', 'model.layers.12.mlp.deepspeed_moe.experts.deepspeed_experts.2.mask', 'model.layers.12.mlp.deepspeed_moe.experts.deepspeed_experts.3.mask', 'model.layers.14.mlp.deepspeed_moe.experts.deepspeed_experts.0.mask', 'model.layers.14.mlp.deepspeed_moe.experts.deepspeed_experts.1.mask', 'model.layers.14.mlp.deepspeed_moe.experts.deepspeed_experts.2.mask', 'model.layers.14.mlp.deepspeed_moe.experts.deepspeed_experts.3.mask', 'model.layers.16.mlp.deepspeed_moe.experts.deepspeed_experts.0.mask', 'model.layers.16.mlp.deepspeed_moe.experts.deepspeed_experts.1.mask', 'model.layers.16.mlp.deepspeed_moe.experts.deepspeed_experts.2.mask', 'model.layers.16.mlp.deepspeed_moe.experts.deepspeed_experts.3.mask', 'model.layers.18.mlp.deepspeed_moe.experts.deepspeed_experts.0.mask', 'model.layers.18.mlp.deepspeed_moe.experts.deepspeed_experts.1.mask', 'model.layers.18.mlp.deepspeed_moe.experts.deepspeed_experts.2.mask', 'model.layers.18.mlp.deepspeed_moe.experts.deepspeed_experts.3.mask', 'model.layers.2.mlp.deepspeed_moe.experts.deepspeed_experts.0.mask', 'model.layers.2.mlp.deepspeed_moe.experts.deepspeed_experts.1.mask', 'model.layers.2.mlp.deepspeed_moe.experts.deepspeed_experts.2.mask', 'model.layers.2.mlp.deepspeed_moe.experts.deepspeed_experts.3.mask', 'model.layers.20.mlp.deepspeed_moe.experts.deepspeed_experts.0.mask', 'model.layers.20.mlp.deepspeed_moe.experts.deepspeed_experts.1.mask', 'model.layers.20.mlp.deepspeed_moe.experts.deepspeed_experts.2.mask', 'model.layers.20.mlp.deepspeed_moe.experts.deepspeed_experts.3.mask', 'model.layers.22.mlp.deepspeed_moe.experts.deepspeed_experts.0.mask', 'model.layers.22.mlp.deepspeed_moe.experts.deepspeed_experts.1.mask', 'model.layers.22.mlp.deepspeed_moe.experts.deepspeed_experts.2.mask', 'model.layers.22.mlp.deepspeed_moe.experts.deepspeed_experts.3.mask', 'model.layers.4.mlp.deepspeed_moe.experts.deepspeed_experts.0.mask', 'model.layers.4.mlp.deepspeed_moe.experts.deepspeed_experts.1.mask', 'model.layers.4.mlp.deepspeed_moe.experts.deepspeed_experts.2.mask', 'model.layers.4.mlp.deepspeed_moe.experts.deepspeed_experts.3.mask', 'model.layers.6.mlp.deepspeed_moe.experts.deepspeed_experts.0.mask', 'model.layers.6.mlp.deepspeed_moe.experts.deepspeed_experts.1.mask', 'model.layers.6.mlp.deepspeed_moe.experts.deepspeed_experts.2.mask', 'model.layers.6.mlp.deepspeed_moe.experts.deepspeed_experts.3.mask', 'model.layers.8.mlp.deepspeed_moe.experts.deepspeed_experts.0.mask', 'model.layers.8.mlp.deepspeed_moe.experts.deepspeed_experts.1.mask', 'model.layers.8.mlp.deepspeed_moe.experts.deepspeed_experts.2.mask', 'model.layers.8.mlp.deepspeed_moe.experts.deepspeed_experts.3.mask']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Loading checkpoint shards: 100%|██████████| 2/2 [00:52<00:00, 22.85s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:52<00:00, 26.33s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:52<00:00, 22.85s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [00:52<00:00, 22.98s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:52<00:00, 26.33s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [00:52<00:00, 26.33s/it]
Some weights of RePaMoELLaVAStablelmForCausalLM were not initialized from the model checkpoint at ./checkpoints/MoE-LLaVA-StableLM-1.6B-4e and are newly initialized: ['model.layers.0.mlp.deepspeed_moe.experts.deepspeed_experts.0.mask', 'model.layers.0.mlp.deepspeed_moe.experts.deepspeed_experts.1.mask', 'model.layers.0.mlp.deepspeed_moe.experts.deepspeed_experts.2.mask', 'model.layers.0.mlp.deepspeed_moe.experts.deepspeed_experts.3.mask', 'model.layers.10.mlp.deepspeed_moe.experts.deepspeed_experts.0.mask', 'model.layers.10.mlp.deepspeed_moe.experts.deepspeed_experts.1.mask', 'model.layers.10.mlp.deepspeed_moe.experts.deepspeed_experts.2.mask', 'model.layers.10.mlp.deepspeed_moe.experts.deepspeed_experts.3.mask', 'model.layers.12.mlp.deepspeed_moe.experts.deepspeed_experts.0.mask', 'model.layers.12.mlp.deepspeed_moe.experts.deepspeed_experts.1.mask', 'model.layers.12.mlp.deepspeed_moe.experts.deepspeed_experts.2.mask', 'model.layers.12.mlp.deepspeed_moe.experts.deepspeed_experts.3.mask', 'model.layers.14.mlp.deepspeed_moe.experts.deepspeed_experts.0.mask', 'model.layers.14.mlp.deepspeed_moe.experts.deepspeed_experts.1.mask', 'model.layers.14.mlp.deepspeed_moe.experts.deepspeed_experts.2.mask', 'model.layers.14.mlp.deepspeed_moe.experts.deepspeed_experts.3.mask', 'model.layers.16.mlp.deepspeed_moe.experts.deepspeed_experts.0.mask', 'model.layers.16.mlp.deepspeed_moe.experts.deepspeed_experts.1.mask', 'model.layers.16.mlp.deepspeed_moe.experts.deepspeed_experts.2.mask', 'model.layers.16.mlp.deepspeed_moe.experts.deepspeed_experts.3.mask', 'model.layers.18.mlp.deepspeed_moe.experts.deepspeed_experts.0.mask', 'model.layers.18.mlp.deepspeed_moe.experts.deepspeed_experts.1.mask', 'model.layers.18.mlp.deepspeed_moe.experts.deepspeed_experts.2.mask', 'model.layers.18.mlp.deepspeed_moe.experts.deepspeed_experts.3.mask', 'model.layers.2.mlp.deepspeed_moe.experts.deepspeed_experts.0.mask', 'model.layers.2.mlp.deepspeed_moe.experts.deepspeed_experts.1.mask', 'model.layers.2.mlp.deepspeed_moe.experts.deepspeed_experts.2.mask', 'model.layers.2.mlp.deepspeed_moe.experts.deepspeed_experts.3.mask', 'model.layers.20.mlp.deepspeed_moe.experts.deepspeed_experts.0.mask', 'model.layers.20.mlp.deepspeed_moe.experts.deepspeed_experts.1.mask', 'model.layers.20.mlp.deepspeed_moe.experts.deepspeed_experts.2.mask', 'model.layers.20.mlp.deepspeed_moe.experts.deepspeed_experts.3.mask', 'model.layers.22.mlp.deepspeed_moe.experts.deepspeed_experts.0.mask', 'model.layers.22.mlp.deepspeed_moe.experts.deepspeed_experts.1.mask', 'model.layers.22.mlp.deepspeed_moe.experts.deepspeed_experts.2.mask', 'model.layers.22.mlp.deepspeed_moe.experts.deepspeed_experts.3.mask', 'model.layers.4.mlp.deepspeed_moe.experts.deepspeed_experts.0.mask', 'model.layers.4.mlp.deepspeed_moe.experts.deepspeed_experts.1.mask', 'model.layers.4.mlp.deepspeed_moe.experts.deepspeed_experts.2.mask', 'model.layers.4.mlp.deepspeed_moe.experts.deepspeed_experts.3.mask', 'model.layers.6.mlp.deepspeed_moe.experts.deepspeed_experts.0.mask', 'model.layers.6.mlp.deepspeed_moe.experts.deepspeed_experts.1.mask', 'model.layers.6.mlp.deepspeed_moe.experts.deepspeed_experts.2.mask', 'model.layers.6.mlp.deepspeed_moe.experts.deepspeed_experts.3.mask', 'model.layers.8.mlp.deepspeed_moe.experts.deepspeed_experts.0.mask', 'model.layers.8.mlp.deepspeed_moe.experts.deepspeed_experts.1.mask', 'model.layers.8.mlp.deepspeed_moe.experts.deepspeed_experts.2.mask', 'model.layers.8.mlp.deepspeed_moe.experts.deepspeed_experts.3.mask']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Some weights of RePaMoELLaVAStablelmForCausalLM were not initialized from the model checkpoint at ./checkpoints/MoE-LLaVA-StableLM-1.6B-4e and are newly initialized: ['model.layers.0.mlp.deepspeed_moe.experts.deepspeed_experts.0.mask', 'model.layers.0.mlp.deepspeed_moe.experts.deepspeed_experts.1.mask', 'model.layers.0.mlp.deepspeed_moe.experts.deepspeed_experts.2.mask', 'model.layers.0.mlp.deepspeed_moe.experts.deepspeed_experts.3.mask', 'model.layers.10.mlp.deepspeed_moe.experts.deepspeed_experts.0.mask', 'model.layers.10.mlp.deepspeed_moe.experts.deepspeed_experts.1.mask', 'model.layers.10.mlp.deepspeed_moe.experts.deepspeed_experts.2.mask', 'model.layers.10.mlp.deepspeed_moe.experts.deepspeed_experts.3.mask', 'model.layers.12.mlp.deepspeed_moe.experts.deepspeed_experts.0.mask', 'model.layers.12.mlp.deepspeed_moe.experts.deepspeed_experts.1.mask', 'model.layers.12.mlp.deepspeed_moe.experts.deepspeed_experts.2.mask', 'model.layers.12.mlp.deepspeed_moe.experts.deepspeed_experts.3.mask', 'model.layers.14.mlp.deepspeed_moe.experts.deepspeed_experts.0.mask', 'model.layers.14.mlp.deepspeed_moe.experts.deepspeed_experts.1.mask', 'model.layers.14.mlp.deepspeed_moe.experts.deepspeed_experts.2.mask', 'model.layers.14.mlp.deepspeed_moe.experts.deepspeed_experts.3.mask', 'model.layers.16.mlp.deepspeed_moe.experts.deepspeed_experts.0.mask', 'model.layers.16.mlp.deepspeed_moe.experts.deepspeed_experts.1.mask', 'model.layers.16.mlp.deepspeed_moe.experts.deepspeed_experts.2.mask', 'model.layers.16.mlp.deepspeed_moe.experts.deepspeed_experts.3.mask', 'model.layers.18.mlp.deepspeed_moe.experts.deepspeed_experts.0.mask', 'model.layers.18.mlp.deepspeed_moe.experts.deepspeed_experts.1.mask', 'model.layers.18.mlp.deepspeed_moe.experts.deepspeed_experts.2.mask', 'model.layers.18.mlp.deepspeed_moe.experts.deepspeed_experts.3.mask', 'model.layers.2.mlp.deepspeed_moe.experts.deepspeed_experts.0.mask', 'model.layers.2.mlp.deepspeed_moe.experts.deepspeed_experts.1.mask', 'model.layers.2.mlp.deepspeed_moe.experts.deepspeed_experts.2.mask', 'model.layers.2.mlp.deepspeed_moe.experts.deepspeed_experts.3.mask', 'model.layers.20.mlp.deepspeed_moe.experts.deepspeed_experts.0.mask', 'model.layers.20.mlp.deepspeed_moe.experts.deepspeed_experts.1.mask', 'model.layers.20.mlp.deepspeed_moe.experts.deepspeed_experts.2.mask', 'model.layers.20.mlp.deepspeed_moe.experts.deepspeed_experts.3.mask', 'model.layers.22.mlp.deepspeed_moe.experts.deepspeed_experts.0.mask', 'model.layers.22.mlp.deepspeed_moe.experts.deepspeed_experts.1.mask', 'model.layers.22.mlp.deepspeed_moe.experts.deepspeed_experts.2.mask', 'model.layers.22.mlp.deepspeed_moe.experts.deepspeed_experts.3.mask', 'model.layers.4.mlp.deepspeed_moe.experts.deepspeed_experts.0.mask', 'model.layers.4.mlp.deepspeed_moe.experts.deepspeed_experts.1.mask', 'model.layers.4.mlp.deepspeed_moe.experts.deepspeed_experts.2.mask', 'model.layers.4.mlp.deepspeed_moe.experts.deepspeed_experts.3.mask', 'model.layers.6.mlp.deepspeed_moe.experts.deepspeed_experts.0.mask', 'model.layers.6.mlp.deepspeed_moe.experts.deepspeed_experts.1.mask', 'model.layers.6.mlp.deepspeed_moe.experts.deepspeed_experts.2.mask', 'model.layers.6.mlp.deepspeed_moe.experts.deepspeed_experts.3.mask', 'model.layers.8.mlp.deepspeed_moe.experts.deepspeed_experts.0.mask', 'model.layers.8.mlp.deepspeed_moe.experts.deepspeed_experts.1.mask', 'model.layers.8.mlp.deepspeed_moe.experts.deepspeed_experts.2.mask', 'model.layers.8.mlp.deepspeed_moe.experts.deepspeed_experts.3.mask']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Some weights of RePaMoELLaVAStablelmForCausalLM were not initialized from the model checkpoint at ./checkpoints/MoE-LLaVA-StableLM-1.6B-4e and are newly initialized: ['model.layers.0.mlp.deepspeed_moe.experts.deepspeed_experts.0.mask', 'model.layers.0.mlp.deepspeed_moe.experts.deepspeed_experts.1.mask', 'model.layers.0.mlp.deepspeed_moe.experts.deepspeed_experts.2.mask', 'model.layers.0.mlp.deepspeed_moe.experts.deepspeed_experts.3.mask', 'model.layers.10.mlp.deepspeed_moe.experts.deepspeed_experts.0.mask', 'model.layers.10.mlp.deepspeed_moe.experts.deepspeed_experts.1.mask', 'model.layers.10.mlp.deepspeed_moe.experts.deepspeed_experts.2.mask', 'model.layers.10.mlp.deepspeed_moe.experts.deepspeed_experts.3.mask', 'model.layers.12.mlp.deepspeed_moe.experts.deepspeed_experts.0.mask', 'model.layers.12.mlp.deepspeed_moe.experts.deepspeed_experts.1.mask', 'model.layers.12.mlp.deepspeed_moe.experts.deepspeed_experts.2.mask', 'model.layers.12.mlp.deepspeed_moe.experts.deepspeed_experts.3.mask', 'model.layers.14.mlp.deepspeed_moe.experts.deepspeed_experts.0.mask', 'model.layers.14.mlp.deepspeed_moe.experts.deepspeed_experts.1.mask', 'model.layers.14.mlp.deepspeed_moe.experts.deepspeed_experts.2.mask', 'model.layers.14.mlp.deepspeed_moe.experts.deepspeed_experts.3.mask', 'model.layers.16.mlp.deepspeed_moe.experts.deepspeed_experts.0.mask', 'model.layers.16.mlp.deepspeed_moe.experts.deepspeed_experts.1.mask', 'model.layers.16.mlp.deepspeed_moe.experts.deepspeed_experts.2.mask', 'model.layers.16.mlp.deepspeed_moe.experts.deepspeed_experts.3.mask', 'model.layers.18.mlp.deepspeed_moe.experts.deepspeed_experts.0.mask', 'model.layers.18.mlp.deepspeed_moe.experts.deepspeed_experts.1.mask', 'model.layers.18.mlp.deepspeed_moe.experts.deepspeed_experts.2.mask', 'model.layers.18.mlp.deepspeed_moe.experts.deepspeed_experts.3.mask', 'model.layers.2.mlp.deepspeed_moe.experts.deepspeed_experts.0.mask', 'model.layers.2.mlp.deepspeed_moe.experts.deepspeed_experts.1.mask', 'model.layers.2.mlp.deepspeed_moe.experts.deepspeed_experts.2.mask', 'model.layers.2.mlp.deepspeed_moe.experts.deepspeed_experts.3.mask', 'model.layers.20.mlp.deepspeed_moe.experts.deepspeed_experts.0.mask', 'model.layers.20.mlp.deepspeed_moe.experts.deepspeed_experts.1.mask', 'model.layers.20.mlp.deepspeed_moe.experts.deepspeed_experts.2.mask', 'model.layers.20.mlp.deepspeed_moe.experts.deepspeed_experts.3.mask', 'model.layers.22.mlp.deepspeed_moe.experts.deepspeed_experts.0.mask', 'model.layers.22.mlp.deepspeed_moe.experts.deepspeed_experts.1.mask', 'model.layers.22.mlp.deepspeed_moe.experts.deepspeed_experts.2.mask', 'model.layers.22.mlp.deepspeed_moe.experts.deepspeed_experts.3.mask', 'model.layers.4.mlp.deepspeed_moe.experts.deepspeed_experts.0.mask', 'model.layers.4.mlp.deepspeed_moe.experts.deepspeed_experts.1.mask', 'model.layers.4.mlp.deepspeed_moe.experts.deepspeed_experts.2.mask', 'model.layers.4.mlp.deepspeed_moe.experts.deepspeed_experts.3.mask', 'model.layers.6.mlp.deepspeed_moe.experts.deepspeed_experts.0.mask', 'model.layers.6.mlp.deepspeed_moe.experts.deepspeed_experts.1.mask', 'model.layers.6.mlp.deepspeed_moe.experts.deepspeed_experts.2.mask', 'model.layers.6.mlp.deepspeed_moe.experts.deepspeed_experts.3.mask', 'model.layers.8.mlp.deepspeed_moe.experts.deepspeed_experts.0.mask', 'model.layers.8.mlp.deepspeed_moe.experts.deepspeed_experts.1.mask', 'model.layers.8.mlp.deepspeed_moe.experts.deepspeed_experts.2.mask', 'model.layers.8.mlp.deepspeed_moe.experts.deepspeed_experts.3.mask']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
/datasets/work/d61-pct/work/yang_work/moe/MoE-LLaVA/moellava/train/llava_trainer.py:187: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `LLaVATrainer.__init__`. Use `processing_class` instead.
  super().__init__(**kwargs)
/datasets/work/d61-pct/work/yang_work/moe/MoE-LLaVA/moellava/train/llava_trainer.py:187: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `LLaVATrainer.__init__`. Use `processing_class` instead.
  super().__init__(**kwargs)
/datasets/work/d61-pct/work/yang_work/moe/MoE-LLaVA/moellava/train/llava_trainer.py:187: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `LLaVATrainer.__init__`. Use `processing_class` instead.
  super().__init__(**kwargs)
The tokenizer has new PAD/BOS/EOS tokens that differ from the model config and generation config. The model config and generation config were aligned accordingly, being updated with the tokenizer's values. Updated tokens: {'bos_token_id': None, 'pad_token_id': 100280}.
The tokenizer has new PAD/BOS/EOS tokens that differ from the model config and generation config. The model config and generation config were aligned accordingly, being updated with the tokenizer's values. Updated tokens: {'bos_token_id': None, 'pad_token_id': 100280}.
The tokenizer has new PAD/BOS/EOS tokens that differ from the model config and generation config. The model config and generation config were aligned accordingly, being updated with the tokenizer's values. Updated tokens: {'bos_token_id': None, 'pad_token_id': 100280}.
/datasets/work/d61-pct/work/yang_work/moe/MoE-LLaVA/moellava/train/llava_trainer.py:187: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `LLaVATrainer.__init__`. Use `processing_class` instead.
  super().__init__(**kwargs)
The tokenizer has new PAD/BOS/EOS tokens that differ from the model config and generation config. The model config and generation config were aligned accordingly, being updated with the tokenizer's values. Updated tokens: {'bos_token_id': None, 'pad_token_id': 100280}.
You are using an old version of the checkpointing format that is deprecated (We will also silently ignore `gradient_checkpointing_kwargs` in case you passed it).Please update to the new format on your modeling file. To use the new format, you need to completely remove the definition of the method `_set_gradient_checkpointing` in your model.
You are using an old version of the checkpointing format that is deprecated (We will also silently ignore `gradient_checkpointing_kwargs` in case you passed it).Please update to the new format on your modeling file. To use the new format, you need to completely remove the definition of the method `_set_gradient_checkpointing` in your model.
You are using an old version of the checkpointing format that is deprecated (We will also silently ignore `gradient_checkpointing_kwargs` in case you passed it).Please update to the new format on your modeling file. To use the new format, you need to completely remove the definition of the method `_set_gradient_checkpointing` in your model.
You are using an old version of the checkpointing format that is deprecated (We will also silently ignore `gradient_checkpointing_kwargs` in case you passed it).Please update to the new format on your modeling file. To use the new format, you need to completely remove the definition of the method `_set_gradient_checkpointing` in your model.
wandb: Tracking run with wandb version 0.21.3
wandb: W&B syncing is set to `offline` in this directory. Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
wandb: Run data is saved locally in /datasets/work/d61-pct/work/yang_work/moe/MoE-LLaVA/wandb/offline-run-20250905_132210-9x7i471s
/home/li309/pct_code/venv/moellava-test2/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:745: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.5 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
/home/li309/pct_code/venv/moellava-test2/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:745: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.5 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
/home/li309/pct_code/venv/moellava-test2/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:745: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.5 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
  0%|          | 0/20791 [00:00<?, ?it/s]/home/li309/pct_code/venv/moellava-test2/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:745: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.5 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
  0%|          | 1/20791 [00:07<41:24:14,  7.17s/it]                                                      0%|          | 1/20791 [00:10<41:24:14,  7.17s/it]  0%|          | 2/20791 [00:11<31:46:02,  5.50s/it]                                                      0%|          | 2/20791 [00:11<31:46:02,  5.50s/it]  0%|          | 3/20791 [00:13<23:48:25,  4.12s/it]                                                      0%|          | 3/20791 [00:13<23:48:25,  4.12s/it]  0%|          | 4/20791 [00:15<18:15:00,  3.16s/it]                                                      0%|          | 4/20791 [00:15<18:15:00,  3.16s/it]  0%|          | 5/20791 [00:17<15:37:49,  2.71s/it]                                                      0%|          | 5/20791 [00:17<15:37:49,  2.71s/it]  0%|          | 6/20791 [00:19<13:53:03,  2.40s/it]                                                      0%|          | 6/20791 [00:19<13:53:03,  2.40s/it]  0%|          | 7/20791 [00:20<12:19:13,  2.13s/it]                                                      0%|          | 7/20791 [00:20<12:19:13,  2.13s/it]  0%|          | 8/20791 [00:22<11:21:44,  1.97s/it]                                                      0%|          | 8/20791 [00:22<11:21:44,  1.97s/it]  0%|          | 9/20791 [00:24<10:39:27,  1.85s/it]                                                      0%|          | 9/20791 [00:24<10:39:27,  1.85s/it]  0%|          | 10/20791 [00:25<9:45:31,  1.69s/it]                                                      0%|          | 10/20791 [00:25<9:45:31,  1.69s/it]  0%|          | 11/20791 [00:27<9:57:59,  1.73s/it]                                                      0%|          | 11/20791 [00:27<9:57:59,  1.73s/it]  0%|          | 12/20791 [00:30<12:18:50,  2.13s/it]                                                       0%|          | 12/20791 [00:30<12:18:50,  2.13s/it]  0%|          | 13/20791 [00:32<11:30:54,  2.00s/it]                                                       0%|          | 13/20791 [00:32<11:30:54,  2.00s/it]  0%|          | 14/20791 [00:33<11:19:04,  1.96s/it]                                                       0%|          | 14/20791 [00:33<11:19:04,  1.96s/it]  0%|          | 15/20791 [00:35<11:03:11,  1.92s/it]                                                       0%|          | 15/20791 [00:35<11:03:11,  1.92s/it]  0%|          | 16/20791 [00:37<10:42:54,  1.86s/it]                                                       0%|          | 16/20791 [00:37<10:42:54,  1.86s/it]  0%|          | 17/20791 [00:39<10:24:02,  1.80s/it]                                                       0%|          | 17/20791 [00:39<10:24:02,  1.80s/it]  0%|          | 18/20791 [00:41<10:45:46,  1.87s/it]                                                       0%|          | 18/20791 [00:41<10:45:46,  1.87s/it]  0%|          | 19/20791 [00:42<10:11:53,  1.77s/it]                                                       0%|          | 19/20791 [00:42<10:11:53,  1.77s/it]  0%|          | 20/20791 [00:44<9:51:20,  1.71s/it]                                                       0%|          | 20/20791 [00:44<9:51:20,  1.71s/it]  0%|          | 21/20791 [00:45<9:36:21,  1.66s/it]                                                      0%|          | 21/20791 [00:45<9:36:21,  1.66s/it]  0%|          | 22/20791 [00:48<11:26:30,  1.98s/it]                                                       0%|          | 22/20791 [00:48<11:26:30,  1.98s/it]  0%|          | 23/20791 [00:50<10:48:03,  1.87s/it]                                                       0%|          | 23/20791 [00:50<10:48:03,  1.87s/it]  0%|          | 24/20791 [00:51<10:24:36,  1.80s/it]                                                       0%|          | 24/20791 [00:51<10:24:36,  1.80s/it]  0%|          | 25/20791 [00:53<9:45:35,  1.69s/it]                                                       0%|          | 25/20791 [00:53<9:45:35,  1.69s/it]  0%|          | 26/20791 [00:54<9:42:09,  1.68s/it]                                                      0%|          | 26/20791 [00:54<9:42:09,  1.68s/it]  0%|          | 27/20791 [00:56<9:26:41,  1.64s/it]                                                      0%|          | 27/20791 [00:56<9:26:41,  1.64s/it]  0%|          | 28/20791 [00:57<9:16:10,  1.61s/it]                                                      0%|          | 28/20791 [00:57<9:16:10,  1.61s/it]  0%|          | 29/20791 [00:59<9:12:52,  1.60s/it]                                                      0%|          | 29/20791 [00:59<9:12:52,  1.60s/it]  0%|          | 30/20791 [01:01<9:10:51,  1.59s/it]                                                      0%|          | 30/20791 [01:01<9:10:51,  1.59s/it]  0%|          | 31/20791 [01:02<9:25:36,  1.63s/it]                                                      0%|          | 31/20791 [01:02<9:25:36,  1.63s/it]  0%|          | 32/20791 [01:04<9:43:33,  1.69s/it]                                                      0%|          | 32/20791 [01:04<9:43:33,  1.69s/it]  0%|          | 33/20791 [01:06<9:53:03,  1.71s/it]                                                      0%|          | 33/20791 [01:06<9:53:03,  1.71s/it]  0%|          | 34/20791 [01:08<9:38:39,  1.67s/it]                                                      0%|          | 34/20791 [01:08<9:38:39,  1.67s/it]  0%|          | 35/20791 [01:10<10:55:16,  1.89s/it]                                                       0%|          | 35/20791 [01:10<10:55:16,  1.89s/it]  0%|          | 36/20791 [01:11<10:18:55,  1.79s/it]                                                       0%|          | 36/20791 [01:11<10:18:55,  1.79s/it]  0%|          | 37/20791 [01:13<10:01:06,  1.74s/it]                                                       0%|          | 37/20791 [01:13<10:01:06,  1.74s/it]  0%|          | 38/20791 [01:15<10:45:16,  1.87s/it]                                                       0%|          | 38/20791 [01:15<10:45:16,  1.87s/it]  0%|          | 39/20791 [01:17<10:56:39,  1.90s/it]                                                       0%|          | 39/20791 [01:17<10:56:39,  1.90s/it]  0%|          | 40/20791 [01:19<10:20:17,  1.79s/it]                                                       0%|          | 40/20791 [01:19<10:20:17,  1.79s/it]  0%|          | 41/20791 [01:20<9:56:56,  1.73s/it]                                                       0%|          | 41/20791 [01:20<9:56:56,  1.73s/it]  0%|          | 42/20791 [01:22<9:41:27,  1.68s/it]                                                      0%|          | 42/20791 [01:22<9:41:27,  1.68s/it]  0%|          | 43/20791 [01:24<9:37:48,  1.67s/it]                                                      0%|          | 43/20791 [01:24<9:37:48,  1.67s/it]  0%|          | 44/20791 [01:25<9:42:21,  1.68s/it]                                                      0%|          | 44/20791 [01:25<9:42:21,  1.68s/it]  0%|          | 45/20791 [01:29<12:41:41,  2.20s/it]                                                       0%|          | 45/20791 [01:29<12:41:41,  2.20s/it]  0%|          | 46/20791 [01:30<11:31:03,  2.00s/it]                                                       0%|          | 46/20791 [01:30<11:31:03,  2.00s/it]  0%|          | 47/20791 [01:32<11:31:00,  2.00s/it]                                                       0%|          | 47/20791 [01:32<11:31:00,  2.00s/it]  0%|          | 48/20791 [01:35<12:22:13,  2.15s/it]                                                       0%|          | 48/20791 [01:35<12:22:13,  2.15s/it]  0%|          | 49/20791 [01:36<11:37:32,  2.02s/it]                                                       0%|          | 49/20791 [01:36<11:37:32,  2.02s/it]  0%|          | 50/20791 [01:39<12:41:05,  2.20s/it]                                                       0%|          | 50/20791 [01:39<12:41:05,  2.20s/it]  0%|          | 51/20791 [01:41<11:36:59,  2.02s/it]                                                       0%|          | 51/20791 [01:41<11:36:59,  2.02s/it]  0%|          | 52/20791 [01:42<10:52:06,  1.89s/it]                                                       0%|          | 52/20791 [01:42<10:52:06,  1.89s/it]  0%|          | 53/20791 [01:44<10:20:35,  1.80s/it]                                                       0%|          | 53/20791 [01:44<10:20:35,  1.80s/it]  0%|          | 54/20791 [01:46<10:11:42,  1.77s/it]                                                       0%|          | 54/20791 [01:46<10:11:42,  1.77s/it]  0%|          | 55/20791 [01:48<11:14:25,  1.95s/it]                                                       0%|          | 55/20791 [01:48<11:14:25,  1.95s/it]  0%|          | 56/20791 [01:50<11:31:22,  2.00s/it]                                                       0%|          | 56/20791 [01:50<11:31:22,  2.00s/it]  0%|          | 57/20791 [01:53<13:22:37,  2.32s/it]                                                       0%|          | 57/20791 [01:53<13:22:37,  2.32s/it]  0%|          | 58/20791 [01:55<12:55:42,  2.24s/it]                                                       0%|          | 58/20791 [01:55<12:55:42,  2.24s/it]  0%|          | 59/20791 [01:58<13:21:36,  2.32s/it]                                                       0%|          | 59/20791 [01:58<13:21:36,  2.32s/it]  0%|          | 60/20791 [01:59<12:01:43,  2.09s/it]                                                       0%|          | 60/20791 [01:59<12:01:43,  2.09s/it]  0%|          | 61/20791 [02:01<11:15:11,  1.95s/it]                                                       0%|          | 61/20791 [02:01<11:15:11,  1.95s/it]  0%|          | 62/20791 [02:03<12:28:26,  2.17s/it]                                                       0%|          | 62/20791 [02:03<12:28:26,  2.17s/it]  0%|          | 63/20791 [02:05<11:30:11,  2.00s/it]                                                       0%|          | 63/20791 [02:05<11:30:11,  2.00s/it]  0%|          | 64/20791 [02:07<12:04:28,  2.10s/it]                                                       0%|          | 64/20791 [02:07<12:04:28,  2.10s/it]  0%|          | 65/20791 [02:09<11:09:59,  1.94s/it]                                                       0%|          | 65/20791 [02:09<11:09:59,  1.94s/it]  0%|          | 66/20791 [02:11<10:43:15,  1.86s/it]                                                       0%|          | 66/20791 [02:11<10:43:15,  1.86s/it]  0%|          | 67/20791 [02:12<10:21:11,  1.80s/it]                                                       0%|          | 67/20791 [02:12<10:21:11,  1.80s/it]  0%|          | 68/20791 [02:14<10:53:33,  1.89s/it]                                                       0%|          | 68/20791 [02:14<10:53:33,  1.89s/it]  0%|          | 69/20791 [02:17<12:05:43,  2.10s/it]                                                       0%|          | 69/20791 [02:17<12:05:43,  2.10s/it]  0%|          | 70/20791 [02:19<11:08:57,  1.94s/it]                                                       0%|          | 70/20791 [02:19<11:08:57,  1.94s/it]  0%|          | 71/20791 [02:20<10:41:44,  1.86s/it]                                                       0%|          | 71/20791 [02:20<10:41:44,  1.86s/it]  0%|          | 72/20791 [02:22<10:11:59,  1.77s/it]                                                       0%|          | 72/20791 [02:22<10:11:59,  1.77s/it]  0%|          | 73/20791 [02:24<10:37:48,  1.85s/it]                                                       0%|          | 73/20791 [02:24<10:37:48,  1.85s/it]  0%|          | 74/20791 [02:26<10:25:55,  1.81s/it]                                                       0%|          | 74/20791 [02:26<10:25:55,  1.81s/it]  0%|          | 75/20791 [02:27<10:26:15,  1.81s/it]                                                       0%|          | 75/20791 [02:27<10:26:15,  1.81s/it]  0%|          | 76/20791 [02:29<10:00:20,  1.74s/it]                                                       0%|          | 76/20791 [02:29<10:00:20,  1.74s/it]  0%|          | 77/20791 [02:31<9:43:54,  1.69s/it]                                                       0%|          | 77/20791 [02:31<9:43:54,  1.69s/it]  0%|          | 78/20791 [02:33<10:18:30,  1.79s/it]                                                       0%|          | 78/20791 [02:33<10:18:30,  1.79s/it]  0%|          | 79/20791 [02:35<11:12:15,  1.95s/it]                                                       0%|          | 79/20791 [02:35<11:12:15,  1.95s/it]  0%|          | 80/20791 [02:36<10:33:23,  1.83s/it]                                                       0%|          | 80/20791 [02:36<10:33:23,  1.83s/it]  0%|          | 81/20791 [02:38<10:24:35,  1.81s/it]                                                       0%|          | 81/20791 [02:38<10:24:35,  1.81s/it]  0%|          | 82/20791 [02:40<10:00:08,  1.74s/it]                                                       0%|          | 82/20791 [02:40<10:00:08,  1.74s/it]  0%|          | 83/20791 [02:41<9:43:16,  1.69s/it]                                                       0%|          | 83/20791 [02:41<9:43:16,  1.69s/it]  0%|          | 84/20791 [02:43<9:47:27,  1.70s/it]                                                      0%|          | 84/20791 [02:43<9:47:27,  1.70s/it]  0%|          | 85/20791 [02:48<15:51:53,  2.76s/it]                                                       0%|          | 85/20791 [02:48<15:51:53,  2.76s/it]  0%|          | 86/20791 [02:50<13:58:01,  2.43s/it]                                                       0%|          | 86/20791 [02:50<13:58:01,  2.43s/it]  0%|          | 87/20791 [02:53<15:34:37,  2.71s/it]                                                       0%|          | 87/20791 [02:53<15:34:37,  2.71s/it]  0%|          | 88/20791 [02:55<13:40:49,  2.38s/it]                                                       0%|          | 88/20791 [02:55<13:40:49,  2.38s/it]  0%|          | 89/20791 [02:59<15:56:32,  2.77s/it]                                                       0%|          | 89/20791 [02:59<15:56:32,  2.77s/it]  0%|          | 90/20791 [03:00<14:19:06,  2.49s/it]                                                       0%|          | 90/20791 [03:00<14:19:06,  2.49s/it]  0%|          | 91/20791 [03:02<12:44:25,  2.22s/it]                                                       0%|          | 91/20791 [03:02<12:44:25,  2.22s/it]  0%|          | 92/20791 [03:04<12:41:17,  2.21s/it]                                                       0%|          | 92/20791 [03:04<12:41:17,  2.21s/it]  0%|          | 93/20791 [03:06<11:33:06,  2.01s/it]                                                       0%|          | 93/20791 [03:06<11:33:06,  2.01s/it]  0%|          | 94/20791 [03:07<10:55:00,  1.90s/it]                                                       0%|          | 94/20791 [03:07<10:55:00,  1.90s/it]  0%|          | 95/20791 [03:09<10:47:40,  1.88s/it]                                                       0%|          | 95/20791 [03:09<10:47:40,  1.88s/it]  0%|          | 96/20791 [03:12<11:52:03,  2.06s/it]                                                       0%|          | 96/20791 [03:12<11:52:03,  2.06s/it]  0%|          | 97/20791 [03:14<11:49:47,  2.06s/it]                                                       0%|          | 97/20791 [03:14<11:49:47,  2.06s/it]  0%|          | 98/20791 [03:15<10:59:29,  1.91s/it]                                                       0%|          | 98/20791 [03:15<10:59:29,  1.91s/it]  0%|          | 99/20791 [03:17<10:21:13,  1.80s/it]                                                       0%|          | 99/20791 [03:17<10:21:13,  1.80s/it]  0%|          | 100/20791 [03:19<11:10:18,  1.94s/it]                                                        0%|          | 100/20791 [03:19<11:10:18,  1.94s/it]  0%|          | 101/20791 [03:21<10:33:40,  1.84s/it]                                                        0%|          | 101/20791 [03:21<10:33:40,  1.84s/it]  0%|          | 102/20791 [03:22<10:07:22,  1.76s/it]                                                        0%|          | 102/20791 [03:22<10:07:22,  1.76s/it]  0%|          | 103/20791 [03:24<9:46:20,  1.70s/it]                                                        0%|          | 103/20791 [03:24<9:46:20,  1.70s/it]  1%|          | 104/20791 [03:26<9:38:59,  1.68s/it]                                                       1%|          | 104/20791 [03:26<9:38:59,  1.68s/it]  1%|          | 105/20791 [03:27<9:56:02,  1.73s/it]                                                       1%|          | 105/20791 [03:27<9:56:02,  1.73s/it]  1%|          | 106/20791 [03:29<9:42:21,  1.69s/it]                                                       1%|          | 106/20791 [03:29<9:42:21,  1.69s/it]  1%|          | 107/20791 [03:31<9:30:51,  1.66s/it]                                                       1%|          | 107/20791 [03:31<9:30:51,  1.66s/it]  1%|          | 108/20791 [03:32<9:23:03,  1.63s/it]                                                       1%|          | 108/20791 [03:32<9:23:03,  1.63s/it]  1%|          | 109/20791 [03:34<9:13:07,  1.60s/it]                                                       1%|          | 109/20791 [03:34<9:13:07,  1.60s/it]  1%|          | 110/20791 [03:35<9:27:55,  1.65s/it]                                                       1%|          | 110/20791 [03:35<9:27:55,  1.65s/it]  1%|          | 111/20791 [03:37<9:17:13,  1.62s/it]                                                       1%|          | 111/20791 [03:37<9:17:13,  1.62s/it]  1%|          | 112/20791 [03:39<9:45:42,  1.70s/it]                                                       1%|          | 112/20791 [03:39<9:45:42,  1.70s/it]  1%|          | 113/20791 [03:40<9:38:20,  1.68s/it]                                                       1%|          | 113/20791 [03:40<9:38:20,  1.68s/it]  1%|          | 114/20791 [03:42<9:50:47,  1.71s/it]                                                       1%|          | 114/20791 [03:42<9:50:47,  1.71s/it]  1%|          | 115/20791 [03:44<9:36:36,  1.67s/it]                                                       1%|          | 115/20791 [03:44<9:36:36,  1.67s/it]  1%|          | 116/20791 [03:45<9:30:20,  1.66s/it]                                                       1%|          | 116/20791 [03:45<9:30:20,  1.66s/it]  1%|          | 117/20791 [03:47<9:51:53,  1.72s/it]                                                       1%|          | 117/20791 [03:47<9:51:53,  1.72s/it]  1%|          | 118/20791 [03:49<9:36:08,  1.67s/it]                                                       1%|          | 118/20791 [03:49<9:36:08,  1.67s/it]